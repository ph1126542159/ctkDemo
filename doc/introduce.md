# `CTK Plugin Framework` 简介

## 相关术语

| 缩写     | 全称                                | 描述               |
|:------:|:---------------------------------:|:----------------:|
| `OSGI` | `Open Service Gateway Initiative` | 开放服务网关协议         |
| `CTK`  | `CTK Plugin Framework`            | 面向 `C++ `的动态模型系统 |

## 简介

<img  src="image/osgi.webp" width="130" height="45"/> 

`OSGI（Open Service Gateway Initiative）`：开放服务网关协议，是`Java`动态化系统一系统规范。`OSGI`是一种模块化架构编程思想，不仅仅适用于`Java`语言，当然也适用于`C++`语言，在`C++`语言中已有相应的实现版本：`CTK Plugin Framework`。

<img  src="image/ctkLogo.webp"/> 

`CTK`与`OSGI`的关系是：`OSGI`是模块化编程设计思想，`CTK`是基于`OSGI`模块化编程设计思想采用`c++/qt`作为开发语言的一个实现版本。

<a href="https://www.osgi.org/" target="_blank">OSGI 官网</a>

<a href="http://www.commontk.org/" target="_blank">CTK Plugin Framework 官网</a>

<a href="https://github.com/commontk/ctk" target="_blank">CTK Plugin Framework github 地址</a>

## 模块组成

`DICOM`：提供支持从`PACS`和本地数据库进行查询和检索操作的高级类。支持建立服务器连接，并发送查询和查看结果。

`DICOM Application Hosting`：提供创建主机和托管应用程序的基础结构。

`Widgets`：用于生物医学成像应用程序的一系例`Qt Widgets`控件的集合。

`Core`：基于`Qt Core`的基础核心层，其它模块都是基于`Core`开发，提供核心类与接口支持。

`Plugin Framework`：基于`OSGI`规范用于`C++`的动态组件系统，应用程序由多个不同的插件动态组成，遵循面向服务的方法。提供插件框架和插件管理等功能。

`Command Line Interfaces`：一种允许将算法编写为自包含可执行程序的技术，无需修改即可在多个终端用户应用环境中使用。

`CTK Plugin Framework`：基于 `Qt Plugin System `和` Qt Service Framework`实现，同时也参考了`Qt Creator`部份设计思想，比如通过嵌入式文本文件向插件添加元数据。

## 优势

### 1.降低复杂度

使用`CTK Plugin Framework`开发插件意味着隐藏了内部实现细节，通过定义良好的服务和插件通信规则，插件的可移植性大大增强。统一接口标准意味着可以自由的更改内部实现，面向接口编程有利于bug数量的减少。

### 2.增强可复用性

采用标准化插件模型，在应用程序中使用第三方组件变得非常容易。标准化插件可服务于多个应用程序，意味着节省大量开发和维护成本。

### 3.符合对现实世界的认知

事实证明，人类社会是高度动态的，而`CTK Plugin Framework`动态服务模型与人类社会现实场景相匹配，这种高度的认知匹配，有利于理解编程思想进行编码实现。例如：当路由器检测到局域网有主机上线，就分配置网络地址。如果检测到有主机关机，路由器就收回分配的网络地址。应用程序可以在其所属的领域中重用`Service Registry`的强大基元，包括注册、获取、过滤和服务监听等。

### 4.动态更新插件

`OSGI`组件模型是一个动态模型，可以在不关闭进程的情况下安装、启动、停止、更新和卸载插件。

### 5.自适应

`Service Registry ` 是一个动态注册表，插件可以向框架注册、获取和监听服务。这种动态服务模型允许插件搜索系统中感兴趣的功能并订阅或调用。

### 6.透明性

管理`API`不仅提供了对插件内部状态的访问，而且还提供了如何与其它插件交互。可以停止部份插件来调试某个特定问题，也可以动态加载诊断插件。

### 7.版本控制

所有插件都必须经过严格的版本控制，只有能够协作的插件才会被启动。插件元数据声明了插件的依赖关系以及依赖的强弱等级。

### 8.简单

调用简单的几行代码就可以实现插件的安装、启动、停止、更新和卸载，插件的依赖管理、监听和通信等功能。

### 9.按需加载/懒加载/延迟加载

应用程序启动时无需加载暂未使用的插件，只有当程序真正需要使用的时候才加载。服务可以提前注册，当程序要使用它时才加载插件。这种机制在嵌入式平台优势非常明显，可以节省一定的硬件资源。

### 10.非侵入式

框架对插件并未加以限制，插件无需实现框架功能，插件只需实现`CTK Plugin Framework`框架提供的启动器接口函数。

### 11.开发简单

`CTK Plugin Framework`不仅定义了插件的编写规范标准，而且还定义了插件安装和管理标准。框架对插件的这种标准化管理，使得开发人员将插件集成到应用程序变得非常容易。